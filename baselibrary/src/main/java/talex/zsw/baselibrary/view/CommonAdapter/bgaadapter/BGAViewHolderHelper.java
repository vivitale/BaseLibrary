package talex.zsw.baselibrary.view.CommonAdapter.bgaadapter;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.drawable.Drawable;
import android.text.Html;
import android.util.SparseArray;
import android.view.View;
import android.widget.Checkable;
import android.widget.ImageView;
import android.widget.TextView;

/**
 * 作者:王浩 邮件:bingoogolapple@gmail.com
 * 创建时间:15/5/26 17:06
 * 描述:为AdapterView和RecyclerView的item设置常见属性（链式编程）
 */
public class BGAViewHolderHelper implements View.OnClickListener,
		View.OnLongClickListener
{
	protected final SparseArray<View> mViews;
	protected BGAOnItemChildClickListener mOnItemChildClickListener;
	protected BGAOnItemChildLongClickListener mOnItemChildLongClickListener;
	protected View mConvertView;
	protected Context mContext;
	protected int mPosition;
	protected BGARecyclerViewHolder mRecyclerViewHolder;
	/**
	 * 留着以后作为扩充对象
	 */
	protected Object mObj;

	public BGAViewHolderHelper(View convertView)
	{
		mViews = new SparseArray<View>();
		mConvertView = convertView;
		mContext = convertView.getContext();
	}

	public void setRecyclerViewHolder(BGARecyclerViewHolder recyclerViewHolder)
	{
		mRecyclerViewHolder = recyclerViewHolder;
	}

	public BGARecyclerViewHolder getRecyclerViewHolder()
	{
		return mRecyclerViewHolder;
	}

	public void setPosition(int position)
	{
		mPosition = position;
	}

	public int getPosition()
	{
		if (mRecyclerViewHolder != null)
		{
			return mRecyclerViewHolder.getAdapterPosition();
		}
		return mPosition;
	}

	/**
	 * 设置item子控件点击事件监听器
	 * 
	 * @param onItemChildClickListener
	 */
	public void setOnItemChildClickListener(
			BGAOnItemChildClickListener onItemChildClickListener)
	{
		mOnItemChildClickListener = onItemChildClickListener;
	}

	/**
	 * 为id为viewId的item子控件设置点击事件监听器
	 * 
	 * @param viewId
	 */
	public void setItemChildClickListener(int viewId)
	{
		getView(viewId).setOnClickListener(this);
	}

	/**
	 * 设置item子控件长按事件监听器
	 * 
	 * @param onItemChildLongClickListener
	 */
	public void setOnItemChildLongClickListener(
			BGAOnItemChildLongClickListener onItemChildLongClickListener)
	{
		mOnItemChildLongClickListener = onItemChildLongClickListener;
	}

	/**
	 * 为id为viewId的item子控件设置长按事件监听器
	 * 
	 * @param viewId
	 */
	public void setItemChildLongClickListener(int viewId)
	{
		getView(viewId).setOnLongClickListener(this);
	}

	@Override
	public void onClick(View v)
	{
		if (mOnItemChildClickListener != null)
		{
			mOnItemChildClickListener.onItemChildClick(v, getPosition());
		}
	}

	@Override
	public boolean onLongClick(View v)
	{
		if (mOnItemChildLongClickListener != null)
		{
			return mOnItemChildLongClickListener.onItemChildLongClick(v,
					getPosition());
		}
		return false;
	}

	/**
	 * 通过控件的Id获取对应的控件，如果没有则加入mViews，则从item根控件中查找并保存到mViews中
	 * 
	 * @param viewId
	 * @return
	 */
	public <T extends View> T getView(int viewId)
	{
		View view = mViews.get(viewId);
		if (view == null)
		{
			view = mConvertView.findViewById(viewId);
			mViews.put(viewId, view);
		}
		return (T) view;
	}

	/**
	 * 获取item的根控件
	 * 
	 * @return
	 */
	public View getConvertView()
	{
		return mConvertView;
	}

	public void setObj(Object obj)
	{
		mObj = obj;
	}

	public Object getObj()
	{
		return mObj;
	}

	/**
	 * 设置对应id的控件的文本内容
	 * 
	 * @param viewId
	 * @param text
	 * @return
	 */
	public BGAViewHolderHelper setText(int viewId, String text)
	{
		TextView view = getView(viewId);
		view.setText(text);
		return this;
	}

	/**
	 * 设置对应id的控件的文本内容
	 * 
	 * @param viewId
	 * @param stringResId
	 *            字符串资源id
	 * @return
	 */
	public BGAViewHolderHelper setText(int viewId, int stringResId)
	{
		TextView view = getView(viewId);
		view.setText(stringResId);
		return this;
	}

	/**
	 * 设置对应id的控件的html文本内容
	 * 
	 * @param viewId
	 * @param source
	 *            html文本
	 * @return
	 */
	public BGAViewHolderHelper setHtml(int viewId, String source)
	{
		TextView view = getView(viewId);
		view.setText(Html.fromHtml(source));
		return this;
	}

	/**
	 * 设置对应id的控件是否选中
	 * 
	 * @param viewId
	 * @param checked
	 * @return
	 */
	public BGAViewHolderHelper setChecked(int viewId, boolean checked)
	{
		Checkable view = (Checkable) getView(viewId);
		view.setChecked(checked);
		return this;
	}

	public BGAViewHolderHelper setTag(int viewId, Object tag)
	{
		View view = getView(viewId);
		view.setTag(tag);
		return this;
	}

	public BGAViewHolderHelper setTag(int viewId, int key, Object tag)
	{
		View view = getView(viewId);
		view.setTag(key, tag);
		return this;
	}

	public BGAViewHolderHelper setVisibility(int viewId, int visibility)
	{
		View view = getView(viewId);
		view.setVisibility(visibility);
		return this;
	}

	public BGAViewHolderHelper setImageBitmap(int viewId, Bitmap bitmap)
	{
		ImageView view = getView(viewId);
		view.setImageBitmap(bitmap);
		return this;
	}

	public BGAViewHolderHelper setImageDrawable(int viewId, Drawable drawable)
	{
		ImageView view = getView(viewId);
		view.setImageDrawable(drawable);
		return this;
	}

	/**
	 * @param viewId
	 * @param textColorResId
	 *            颜色资源id
	 * @return
	 */
	public BGAViewHolderHelper setTextColorRes(int viewId, int textColorResId)
	{
		TextView view = getView(viewId);
		view.setTextColor(mContext.getResources().getColor(textColorResId));
		return this;
	}

	/**
	 * @param viewId
	 * @param textColor
	 *            颜色值
	 * @return
	 */
	public BGAViewHolderHelper setTextColor(int viewId, int textColor)
	{
		TextView view = getView(viewId);
		view.setTextColor(textColor);
		return this;
	}

	/**
	 * @param viewId
	 * @param backgroundResId
	 *            背景资源id
	 * @return
	 */
	public BGAViewHolderHelper setBackgroundRes(int viewId, int backgroundResId)
	{
		View view = getView(viewId);
		view.setBackgroundResource(backgroundResId);
		return this;
	}

	/**
	 * @param viewId
	 * @param color
	 *            颜色值
	 * @return
	 */
	public BGAViewHolderHelper setBackgroundColor(int viewId, int color)
	{
		View view = getView(viewId);
		view.setBackgroundColor(color);
		return this;
	}

	/**
	 * @param viewId
	 * @param colorResId
	 *            颜色值资源id
	 * @return
	 */
	public BGAViewHolderHelper setBackgroundColorRes(int viewId, int colorResId)
	{
		View view = getView(viewId);
		view.setBackgroundColor(mContext.getResources().getColor(colorResId));
		return this;
	}

	/**
	 * @param viewId
	 * @param imageResId
	 *            图像资源id
	 * @return
	 */
	public BGAViewHolderHelper setImageResource(int viewId, int imageResId)
	{
		ImageView view = getView(viewId);
		view.setImageResource(imageResId);
		return this;
	}
}